# Codecov configuration
# https://docs.codecov.com/docs/codecovyml-reference

# Exclude files from coverage calculation
ignore:
  # Integration-only code (requires real database)
  - "examples/hello-mysql/internal/modules/users/repo_mysql.go"
  # Untestable entry point
  - "examples/hello-mysql/cmd/api/main.go"

coverage:
  status:
    # Project coverage: overall repository coverage check
    project:
      default:
        # target: auto uses the base branch coverage as the target
        # PRs must not decrease overall coverage
        target: auto
        # threshold: allows up to 1% drop before failing
        # prevents flaky failures from minor fluctuations
        threshold: 1%

    # Patch coverage: coverage of new/changed lines only
    patch:
      default:
        # 80% of new/changed lines must be covered by tests
        # encourages testing new code while allowing flexibility
        target: 80%

# PR comment configuration
comment:
  # Layout sections: header, coverage diff, flags, file list
  layout: "header,diff,flags,files"
  # Posts new comment on each push, updates existing comment
  behavior: default
